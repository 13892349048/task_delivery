# 项目目录结构说明

## 整体架构

本项目采用标准的Go项目布局（Go Standard Project Layout），遵循Go社区最佳实践。

```
taskmanage/
├── cmd/                    # 应用程序入口
├── internal/              # 私有应用程序代码
├── pkg/                   # 公共库代码
├── configs/               # 配置文件
├── scripts/               # 构建、安装、分析等脚本
├── migrations/            # 数据库迁移文件
├── test/                  # 测试文件和测试数据
├── web/                   # Web应用程序资源
├── deployments/           # 部署配置和模板
├── docs/                  # 设计和用户文档
└── 项目流程图/            # 业务流程图
```

## 详细目录说明

### `/cmd` - 应用程序入口
```
cmd/
└── taskmanage/
    └── main.go           # 主程序入口
```
- **作用**: 包含应用程序的主要入口点
- **原则**: 每个应用程序的目录名应该与可执行文件名匹配
- **内容**: 导入和调用 `/internal` 和 `/pkg` 目录中的代码

### `/internal` - 私有应用程序代码
```
internal/
├── api/                  # API层
│   ├── handlers/         # HTTP处理器
│   ├── routes/           # 路由定义
│   └── middleware/       # API中间件
├── config/               # 配置管理
├── database/             # 数据库连接和操作
├── models/               # 数据模型
├── services/             # 业务逻辑层
│   ├── auth/            # 认证服务
│   ├── task/            # 任务管理服务
│   ├── employee/        # 员工管理服务
│   ├── assignment/      # 任务分配服务
│   └── approval/        # 审批流程服务
├── middleware/           # 全局中间件
├── utils/                # 内部工具函数
└── workers/              # 异步任务处理器
```

**核心原则**: 
- 这些代码不希望被其他应用程序或库导入
- Go编译器会强制执行这个约定
- 包含应用程序的核心业务逻辑

### `/pkg` - 公共库代码
```
pkg/
├── logger/               # 日志工具
├── validator/            # 数据验证
├── response/             # 统一响应格式
├── jwt/                  # JWT工具
└── crypto/               # 加密工具
```
- **作用**: 可以被外部应用程序使用的库代码
- **原则**: 如果代码可以被其他项目安全使用，就放在这里

### `/configs` - 配置文件
```
configs/
├── config.yaml           # 主配置文件
├── config.dev.yaml       # 开发环境配置
├── config.prod.yaml      # 生产环境配置
└── config.test.yaml      # 测试环境配置
```

### `/scripts` - 脚本文件
```
scripts/
├── build.sh              # 构建脚本
├── deploy.sh             # 部署脚本
├── migrate.sh            # 数据库迁移脚本
└── test.sh               # 测试脚本
```

### `/migrations` - 数据库迁移
```
migrations/
├── 000001_create_users_table.up.sql
├── 000001_create_users_table.down.sql
├── 000002_create_tasks_table.up.sql
└── 000002_create_tasks_table.down.sql
```

### `/test` - 测试相关
```
test/
├── integration/          # 集成测试
├── fixtures/             # 测试数据
└── mocks/                # Mock对象
```

### `/web` - Web资源
```
web/
├── static/               # 静态文件
├── templates/            # 模板文件
└── assets/               # 前端资源
```

### `/deployments` - 部署配置
```
deployments/
├── docker/
│   ├── Dockerfile
│   └── docker-compose.yml
├── kubernetes/
│   ├── deployment.yaml
│   └── service.yaml
└── terraform/            # 基础设施代码
```

## 模块依赖关系

### 分层架构
```
┌─────────────────┐
│   API Layer     │  ← /internal/api (handlers, routes, middleware)
├─────────────────┤
│ Business Layer  │  ← /internal/services (业务逻辑)
├─────────────────┤
│   Data Layer    │  ← /internal/models, /internal/database
├─────────────────┤
│ Infrastructure  │  ← /pkg (公共工具), /internal/utils
└─────────────────┘
```

### 依赖方向
- **API层** → **业务层** → **数据层** → **基础设施层**
- **上层可以依赖下层，下层不能依赖上层**
- **同层之间尽量避免直接依赖**

## 核心模块功能

### 1. API层 (`/internal/api`)
- **handlers/**: HTTP请求处理器，负责请求解析和响应
- **routes/**: 路由配置，定义URL到处理器的映射
- **middleware/**: API级别的中间件（认证、限流、日志等）

### 2. 业务层 (`/internal/services`)
- **auth/**: 用户认证、授权、JWT管理
- **task/**: 任务CRUD、状态管理、查询过滤
- **employee/**: 员工信息管理、技能标签、状态跟踪
- **assignment/**: 智能分配算法、分配策略、负载均衡
- **approval/**: 审批流程、工作流引擎、状态流转

### 3. 数据层 (`/internal/models`, `/internal/database`)
- **models/**: GORM模型定义、数据库表结构
- **database/**: 数据库连接、事务管理、查询构建

### 4. 基础设施层 (`/pkg`, `/internal/utils`)
- **logger/**: 结构化日志、日志级别、日志轮转
- **validator/**: 数据验证规则、自定义验证器
- **response/**: 统一API响应格式、错误处理
- **jwt/**: JWT生成、验证、刷新
- **crypto/**: 密码加密、数据加密

### 5. 异步处理 (`/internal/workers`)
- **task_processor/**: 任务分配处理器
- **notification/**: 通知发送处理器
- **report/**: 报表生成处理器

## 开发规范

### 命名约定
- **包名**: 小写，简短，有意义
- **文件名**: 小写，下划线分隔
- **接口**: 以 `er` 结尾 (如 `TaskManager`)
- **结构体**: 大驼峰命名 (如 `TaskService`)

### 文件组织
- 每个包应该有明确的职责
- 相关功能放在同一个包中
- 避免循环依赖
- 保持包的大小适中

### 导入规则
```go
import (
    // 标准库
    "context"
    "fmt"
    
    // 第三方库
    "github.com/gin-gonic/gin"
    "gorm.io/gorm"
    
    // 项目内部包
    "taskmanage/internal/models"
    "taskmanage/pkg/logger"
)
```

## 扩展性设计

### 微服务准备
- 每个 `/internal/services` 子模块都可以独立成微服务
- 通过接口定义服务边界
- 支持配置驱动的服务发现

### 插件化支持
- 分配算法可插拔设计
- 审批流程可配置化
- 通知方式可扩展

### 性能优化
- 数据库连接池
- Redis缓存层
- 异步任务队列
- 监控和指标收集

这个目录结构为项目提供了清晰的组织方式，便于团队协作和项目维护。
